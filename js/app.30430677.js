(function(){"use strict";var e={3846:function(e,t,n){var r=n(5130),a=n(2053),i=(n(4188),n(6768));const l={id:"app"};function o(e,t,n,r,a,o){const u=(0,i.g2)("el-header"),s=(0,i.g2)("router-view"),c=(0,i.g2)("el-main"),d=(0,i.g2)("el-container");return(0,i.uX)(),(0,i.CE)("div",l,[(0,i.bF)(d,null,{default:(0,i.k6)((()=>[(0,i.bF)(u,null,{default:(0,i.k6)((()=>t[0]||(t[0]=[(0,i.Lk)("div",{class:"header-content"},[(0,i.Lk)("h1",null,"医院药房管理系统")],-1)]))),_:1}),(0,i.bF)(c,null,{default:(0,i.k6)((()=>[(0,i.bF)(s)])),_:1})])),_:1})])}var u={name:"App"},s=n(1241);const c=(0,s.A)(u,[["render",o]]);var d=c,p=n(1387),f=n(4232);const b={class:"drug-list"},v={class:"header"},g={class:"prescription-details"},h={class:"detail-item"},k={class:"detail-item"},m={class:"detail-item"},_={class:"dialog-footer"};function y(e,t,n,r,a,l){const o=(0,i.g2)("Search"),u=(0,i.g2)("el-icon"),s=(0,i.g2)("el-input"),c=(0,i.g2)("el-table-column"),d=(0,i.g2)("el-tag"),p=(0,i.g2)("el-button"),y=(0,i.g2)("el-table"),w=(0,i.g2)("el-dialog");return(0,i.uX)(),(0,i.CE)("div",b,[(0,i.Lk)("div",v,[t[3]||(t[3]=(0,i.Lk)("h2",null,"处方列表",-1)),(0,i.bF)(s,{modelValue:r.searchQuery,"onUpdate:modelValue":t[0]||(t[0]=e=>r.searchQuery=e),placeholder:"请输入患者姓名或预约号搜索",class:"search-input",onInput:r.handleSearch},{prefix:(0,i.k6)((()=>[(0,i.bF)(u,null,{default:(0,i.k6)((()=>[(0,i.bF)(o)])),_:1})])),_:1},8,["modelValue","onInput"])]),(0,i.bF)(y,{data:r.prescriptionList,style:{width:"100%"},border:""},{default:(0,i.k6)((()=>[(0,i.bF)(c,{prop:"id",label:"预约编号",width:"120"}),(0,i.bF)(c,{prop:"user_name",label:"患者姓名",width:"120"}),(0,i.bF)(c,{prop:"diagnose_result",label:"诊断结果",width:"200"}),(0,i.bF)(c,{prop:"prescription",label:"处方信息",width:"300"}),(0,i.bF)(c,{prop:"drugStatus",label:"状态",width:"120"},{default:(0,i.k6)((e=>[(0,i.bF)(d,{type:"待取药"===e.row.drugStatus?"warning":"success"},{default:(0,i.k6)((()=>[(0,i.eW)((0,f.v_)(e.row.drugStatus||"待取药"),1)])),_:2},1032,["type"])])),_:1}),(0,i.bF)(c,{label:"操作",width:"150"},{default:(0,i.k6)((e=>[(0,i.bF)(p,{type:"primary",size:"small",onClick:t=>r.handleDispenseDrugs(e.row),disabled:"已取药"===e.row.drugStatus},{default:(0,i.k6)((()=>t[4]||(t[4]=[(0,i.eW)(" 发药 ")]))),_:2},1032,["onClick","disabled"]),(0,i.bF)(p,{type:"info",size:"small",onClick:t=>r.viewDetails(e.row)},{default:(0,i.k6)((()=>t[5]||(t[5]=[(0,i.eW)(" 详情 ")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),(0,i.bF)(w,{modelValue:r.dialogVisible,"onUpdate:modelValue":t[2]||(t[2]=e=>r.dialogVisible=e),title:"发药确认",width:"50%"},{footer:(0,i.k6)((()=>[(0,i.Lk)("span",_,[(0,i.bF)(p,{onClick:t[1]||(t[1]=e=>r.dialogVisible=!1)},{default:(0,i.k6)((()=>t[10]||(t[10]=[(0,i.eW)("取消")]))),_:1}),(0,i.bF)(p,{type:"primary",onClick:r.confirmDispense},{default:(0,i.k6)((()=>t[11]||(t[11]=[(0,i.eW)(" 确认发药 ")]))),_:1},8,["onClick"])])])),default:(0,i.k6)((()=>[(0,i.Lk)("div",g,[t[9]||(t[9]=(0,i.Lk)("h3",null,"处方详情",-1)),(0,i.Lk)("div",h,[t[6]||(t[6]=(0,i.Lk)("span",{class:"label"},"患者姓名：",-1)),(0,i.Lk)("span",null,(0,f.v_)(r.currentPrescription.user_name||"未知"),1)]),(0,i.Lk)("div",k,[t[7]||(t[7]=(0,i.Lk)("span",{class:"label"},"诊断结果：",-1)),(0,i.Lk)("span",null,(0,f.v_)(r.currentPrescription.diagnose_result||"暂无诊断"),1)]),(0,i.Lk)("div",m,[t[8]||(t[8]=(0,i.Lk)("span",{class:"label"},"处方信息：",-1)),(0,i.Lk)("span",null,(0,f.v_)(r.currentPrescription.prescription||"暂无处方"),1)])])])),_:1},8,["modelValue"])])}n(8992),n(4520),n(1454);var w=n(144),L=n(4373),F=n(1219),S=n(2933),C=n(7477),O={name:"DrugList",components:{Search:C.vji},setup(){const e=(0,w.KR)([]),t=(0,w.KR)(""),n=(0,w.KR)(!1),r=(0,w.KR)({}),a=async()=>{try{const t=await L.A.get("/api/appointments/doctor/33");200===t.data.code?e.value=t.data.data.filter((e=>e.diagnose_result||e.prescription)).map((e=>({...e,userName:e.user_name||"未知患者",diagnoseResult:e.diagnose_result||"暂无诊断",prescription:e.prescription||"暂无处方",drugStatus:e.drugStatus||"待取药"}))):F.nk.error(t.data.msg||"获取数据失败")}catch(t){console.error("获取处方列表失败:",t),F.nk.error("获取处方列表失败，请检查后端服务是否正常运行")}},l=()=>{if(!t.value)return void a();const n=t.value.toLowerCase();e.value=e.value.filter((e=>e.user_name?.toLowerCase().includes(n)||e.id?.toString().includes(n)))},o=e=>{r.value=e,n.value=!0},u=async()=>{try{await L.A.put(`/api/appointments/${r.value.id}`,{...r.value,drugStatus:"已取药"});const t=e.value.findIndex((e=>e.id===r.value.id));-1!==t&&(e.value[t].drugStatus="已取药"),F.nk.success("发药成功"),n.value=!1}catch(t){console.error("发药确认失败:",t),F.nk.error("发药确认失败，请稍后重试")}},s=e=>{r.value=e,S.s.alert(`\n        患者姓名：${e.user_name||"未知"}\n        预约编号：${e.id}\n        诊断结果：${e.diagnose_result||"暂无诊断"}\n        处方信息：${e.prescription||"暂无处方"}\n        取药状态：${e.drugStatus||"待取药"}\n        `,"处方详情",{confirmButtonText:"确定"})};return(0,i.sV)((()=>{a()})),{prescriptionList:e,searchQuery:t,dialogVisible:n,currentPrescription:r,handleSearch:l,handleDispenseDrugs:o,confirmDispense:u,viewDetails:s}}};const V=(0,s.A)(O,[["render",y],["__scopeId","data-v-0adb396a"]]);var D=V;const j=[{path:"/",name:"DrugList",component:D}],x=(0,p.aE)({history:(0,p.LA)("/"),routes:j});var A=x;L.A.defaults.baseURL="http://localhost:8080";const P=(0,r.Ef)(d);P.use(a.A),P.use(A),P.mount("#app")}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}n.m=e,function(){var e=[];n.O=function(t,r,a,i){if(!r){var l=1/0;for(c=0;c<e.length;c++){r=e[c][0],a=e[c][1],i=e[c][2];for(var o=!0,u=0;u<r.length;u++)(!1&i||l>=i)&&Object.keys(n.O).every((function(e){return n.O[e](r[u])}))?r.splice(u--,1):(o=!1,i<l&&(l=i));if(o){e.splice(c--,1);var s=a();void 0!==s&&(t=s)}}return t}i=i||0;for(var c=e.length;c>0&&e[c-1][2]>i;c--)e[c]=e[c-1];e[c]=[r,a,i]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};n.O.j=function(t){return 0===e[t]};var t=function(t,r){var a,i,l=r[0],o=r[1],u=r[2],s=0;if(l.some((function(t){return 0!==e[t]}))){for(a in o)n.o(o,a)&&(n.m[a]=o[a]);if(u)var c=u(n)}for(t&&t(r);s<l.length;s++)i=l[s],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return n.O(c)},r=self["webpackChunkdrug"]=self["webpackChunkdrug"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=n.O(void 0,[504],(function(){return n(3846)}));r=n.O(r)})();
//# sourceMappingURL=app.30430677.js.map